

<!DOCTYPE html>
<html lang="zh-CN" data-default-color-scheme=auto>



<head>
  <meta charset="UTF-8">
  <link rel="apple-touch-icon" sizes="76x76" href="/img/fluid.png">
  <link rel="icon" href="/img/fluid.png">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, shrink-to-fit=no">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  
  <meta name="theme-color" content="#9ce8f452">
  <meta name="author" content="严千屹">
  <meta name="keywords" content="">
  
    <meta name="description" content="上课笔记">
<meta property="og:type" content="article">
<meta property="og:title" content="Docker笔记">
<meta property="og:url" content="https://blog.qianyios.top/2023/03/26/Docker%20node/index.html">
<meta property="og:site_name" content="严千屹博客">
<meta property="og:description" content="上课笔记">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://article.biliimg.com/bfs/article/53832a4dc28d9a9bab39ca9965583eb5a487b946.png">
<meta property="article:published_time" content="2023-03-26T13:16:39.000Z">
<meta property="article:modified_time" content="2023-07-08T09:13:25.462Z">
<meta property="article:author" content="严千屹">
<meta property="article:tag" content="Docker">
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:image" content="https://article.biliimg.com/bfs/article/53832a4dc28d9a9bab39ca9965583eb5a487b946.png">
  
  
    <meta name="referrer" content="no-referrer-when-downgrade">
  
  
  <title>Docker笔记 - 严千屹博客</title>

  <link  rel="stylesheet" href="https://lib.baomitu.com/twitter-bootstrap/4.6.1/css/bootstrap.min.css" />



  <link  rel="stylesheet" href="https://lib.baomitu.com/github-markdown-css/4.0.0/github-markdown.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/hint.css/2.7.0/hint.min.css" />

  <link  rel="stylesheet" href="https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.css" />



<!-- 主题依赖的图标库，不要自行修改 -->
<!-- Do not modify the link that theme dependent icons -->

<link rel="stylesheet" href="//at.alicdn.com/t/font_1749284_hj8rtnfg7um.css">



<link rel="stylesheet" href="//at.alicdn.com/t/font_1736178_lbnruvf0jn.css">


<link  rel="stylesheet" href="/css/main.css" />


  <link id="highlight-css" rel="stylesheet" href="/css/highlight.css" />
  
    <link id="highlight-css-dark" rel="stylesheet" href="/css/highlight-dark.css" />
  



  
<link rel="stylesheet" href="/css/mycss.css">



  <script id="fluid-configs">
    var Fluid = window.Fluid || {};
    Fluid.ctx = Object.assign({}, Fluid.ctx)
    var CONFIG = {"hostname":"blog.qianyios.top","root":"/","version":"1.9.4","typing":{"enable":true,"typeSpeed":70,"cursorChar":"_","loop":true,"scope":[]},"anchorjs":{"enable":true,"element":"h1,h2,h3,h4,h5,h6","placement":"right","visible":"hover","icon":""},"progressbar":{"enable":true,"height_px":3,"color":"#29d","options":{"showSpinner":false,"trickleSpeed":100}},"code_language":{"enable":true,"default":"TEXT"},"copy_btn":true,"image_caption":{"enable":true},"image_zoom":{"enable":true,"img_url_replace":["",""]},"toc":{"enable":true,"placement":"right","headingSelector":"h1,h2,h3,h4,h5,h6","collapseDepth":0},"lazyload":{"enable":true,"loading_img":"/img/loading.gif","onlypost":false,"offset_factor":2},"web_analytics":{"enable":false,"follow_dnt":true,"baidu":null,"google":null,"gtag":null,"tencent":{"sid":null,"cid":null},"woyaola":null,"cnzz":null,"leancloud":{"app_id":null,"app_key":null,"server_url":null,"path":"window.location.pathname","ignore_local":false}},"search_path":"/local-search.xml"};

    if (CONFIG.web_analytics.follow_dnt) {
      var dntVal = navigator.doNotTrack || window.doNotTrack || navigator.msDoNotTrack;
      Fluid.ctx.dnt = dntVal && (dntVal.startsWith('1') || dntVal.startsWith('yes') || dntVal.startsWith('on'));
    }
  </script>
  <script  src="/js/utils.js" ></script>
  <script  src="/js/color-schema.js" ></script>
  

  <meta name="referrer" content="no-referrer"/>

  
<meta name="generator" content="Hexo 6.3.0"></head>


<body>
  

  <header>
    

<div class="header-inner" style="height: 70vh;">
  <nav id="navbar" class="navbar fixed-top  navbar-expand-lg navbar-dark scrolling-navbar">
  <div class="container">
    <a class="navbar-brand" href="/">
      <strong>严 千 屹</strong>
    </a>

    <button id="navbar-toggler-btn" class="navbar-toggler" type="button" data-toggle="collapse"
            data-target="#navbarSupportedContent"
            aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
      <div class="animated-icon"><span></span><span></span><span></span></div>
    </button>

    <!-- Collapsible content -->
    <div class="collapse navbar-collapse" id="navbarSupportedContent">
      <ul class="navbar-nav ml-auto text-center">
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/">
                <i class="iconfont icon-home-fill"></i>
                <span>首页</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/archives/">
                <i class="iconfont icon-archive-fill"></i>
                <span>归档</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/tags/">
                <i class="iconfont icon-tags-fill"></i>
                <span>标签</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/about/">
                <i class="iconfont icon-user-fill"></i>
                <span>关于</span>
              </a>
            </li>
          
        
          
          
          
          
            <li class="nav-item">
              <a class="nav-link" href="/links/">
                <i class="iconfont icon-link-fill"></i>
                <span>友链</span>
              </a>
            </li>
          
        
        
          <li class="nav-item" id="search-btn">
            <a class="nav-link" target="_self" href="javascript:;" data-toggle="modal" data-target="#modalSearch" aria-label="Search">
              <i class="iconfont icon-search"></i>
            </a>
          </li>
          
        
        
          <li class="nav-item" id="color-toggle-btn">
            <a class="nav-link" target="_self" href="javascript:;" aria-label="Color Toggle">
              <i class="iconfont icon-dark" id="color-toggle-icon"></i>
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</nav>

  

<div id="banner" class="banner" parallax=true
     style="background: url('/null') no-repeat center center; background-size: cover;">
  <div class="full-bg-img">
    <div class="mask flex-center" style="background-color: rgba(0, 0, 0, 0)">
      <div class="banner-text text-center fade-in-up">
        <div class="h2">
          
            <span id="subtitle" data-typed-text="Docker笔记"></span>
          
        </div>

        
          
  <div class="mt-3">
    
    
      <span class="post-meta">
        <i class="iconfont icon-date-fill" aria-hidden="true"></i>
        <time datetime="2023-03-26 13:16" pubdate>
          2023年3月26日 下午
        </time>
      </span>
    
  </div>

  <div class="mt-1">
    
      <span class="post-meta mr-2">
        <i class="iconfont icon-chart"></i>
        
          18k 字
        
      </span>
    

    
      <span class="post-meta mr-2">
        <i class="iconfont icon-clock-fill"></i>
        
        
        
          154 分钟
        
      </span>
    

    
    
  </div>


        
      </div>

      
    </div>
  </div>
</div>

</div>

  </header>

  <main>
    
      

<div class="container-fluid nopadding-x">
  <div class="row nomargin-x">
    <div class="side-col d-none d-lg-block col-lg-2">
      

    </div>

    <div class="col-lg-8 nopadding-x-md">
      <div class="container nopadding-x-md" id="board-ctn">
        <div id="board">
          <article class="post-content mx-auto">
            <!-- SEO header -->
            <h1 style="display: none">Docker笔记</h1>
            
            
              <div class="markdown-body">
                
                <meta name="referrer" content="no-referrer"/>

<h1 id="Docker笔记"><a href="#Docker笔记" class="headerlink" title="Docker笔记"></a>Docker笔记</h1><p>结合<a href="https://blog.qianyios.top/2023/01/17/docker/">Centos 8 使用Docker实现容器 - 严千屹 (qianyios.top)</a>搭建的Docker实现本次笔记的所有内容及例子</p>
<p>也可以使用以下Centos7部署Docker CE 19.03实现本实验的所有例子</p>
<h2 id="Centos7部署Docker-CE-19-03"><a href="#Centos7部署Docker-CE-19-03" class="headerlink" title="Centos7部署Docker CE 19.03"></a>Centos7部署Docker CE 19.03</h2><p>（2023年4月8日01点00分）当前最常用的 Docker 版本是 Docker CE 19.03。这是 Docker 社区版（Community Edition）的最新版本，它包括一些更新和新功能，如多阶段构建、Dockerfile 中的 ARG 和 FROM 指令以及与 Kubernetes 的更好集成等。另外，Docker CE 19.03 支持 Windows、MacOS 和 Linux 操作系统。</p>
<h3 id="卸载旧版本"><a href="#卸载旧版本" class="headerlink" title="卸载旧版本"></a>卸载旧版本</h3><figure class="highlight livescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs livescript">sudo yum -y remove docker <span class="hljs-string">\</span><br>                  docker-client <span class="hljs-string">\</span><br>                  docker-client-latest <span class="hljs-string">\</span><br>                  docker-common <span class="hljs-string">\</span><br>                  docker-latest <span class="hljs-string">\</span><br>                  docker-latest-logrotate <span class="hljs-string">\</span><br>                  docker-logrotate <span class="hljs-string">\</span><br>                  docker-selinux <span class="hljs-string">\</span><br>                  docker-engine-selinux <span class="hljs-string">\</span><br>                  docker-engine<br>sudo yum remove docker-ce docker-ce-cli containerd.io docker-compose docker-machine docker-swarm<br>sudo rm /etc/yum.repos.d/docker-ce.repo<br>sudo rm -rf /<span class="hljs-keyword">var</span>/lib/docker<br></code></pre></td></tr></table></figure>

<h3 id="安装docker"><a href="#安装docker" class="headerlink" title="安装docker"></a>安装docker</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs awk">sudo yum install -y yum-utils device-mapper-persistent-data lvm2<br>sudo yum-config-manager --add-repo https:<span class="hljs-regexp">//</span>download.docker.com<span class="hljs-regexp">/linux/</span>centos/docker-ce.repo<br>sudo yum install docker-ce docker-ce-cli containerd.io -y<br>sudo systemctl start docker<br>docker version<br>sudo curl -L <span class="hljs-string">&quot;https://github.com/docker/compose/releases/download/1.28.6/docker-compose-$(uname -s)-$(uname -m)&quot;</span> -o <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose<br>sudo chmod +x <span class="hljs-regexp">/usr/</span>local<span class="hljs-regexp">/bin/</span>docker-compose<br>docker-compose --version<br></code></pre></td></tr></table></figure>

<h2 id="Docker的常用命令"><a href="#Docker的常用命令" class="headerlink" title="Docker的常用命令"></a>Docker的常用命令</h2><figure class="highlight jboss-cli"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs jboss-cli">docker <span class="hljs-keyword">version</span>		   <span class="hljs-comment"># 显示docker的版本信息</span><br>docker info			   <span class="hljs-comment"># 显示docker的系统信息,包括镜像和容器的数量</span><br>docker 命令 <span class="hljs-params">--help</span> 	   <span class="hljs-comment"># 帮助命令</span><br></code></pre></td></tr></table></figure>

<h2 id="镜像命令"><a href="#镜像命令" class="headerlink" title="镜像命令"></a>镜像命令</h2><h3 id="镜像命令-1"><a href="#镜像命令-1" class="headerlink" title="镜像命令"></a>镜像命令</h3><figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">docker images		<span class="hljs-comment"># 查看所有本地的主机上的镜像</span><br>-a,--al1	<span class="hljs-comment"># 列出所有镜像</span><br>-q,--quiet	<span class="hljs-comment"># 只显示镜像的id</span><br><span class="hljs-comment"># 解释</span><br>REPOSITORY        <span class="hljs-keyword">TAG</span>         <span class="hljs-title">IMAGE</span> ID        CREATED          SIZE<br>镜像的仓库源      镜像的标签  镜像的id        镜像的创建时间   镜像的大小<br></code></pre></td></tr></table></figure>

<h3 id="搜索命令"><a href="#搜索命令" class="headerlink" title="搜索命令"></a>搜索命令</h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@docker</span> ~]<span class="hljs-meta"># docker search centos</span><br>NAME    DESCRIPTION    STARS                               OFFICIAL  AUTOMATED<br>centos  DEPRECATED<span class="hljs-comment">;    The official build of CentOS.       7537      [OK]</span><br>检索Docker仓库中的Ubuntu镜像<br></code></pre></td></tr></table></figure>

<h3 id="拉取镜像"><a href="#拉取镜像" class="headerlink" title="拉取镜像"></a>拉取镜像</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">[root@docker ~]<span class="hljs-comment"># docke pull 镜像名[:tag]		#下载镜像</span><br><span class="hljs-comment"># 如果不写tag，默认就是latest</span><br><br>[root@docker ~]<span class="hljs-comment"># docker pull centos</span><br>Using <span class="hljs-keyword">default</span> tag: latest<br>latest: Pulling <span class="hljs-keyword">from</span> library/centos<br>a1d0c7532777: Pull complete<br>Digest: sha256:a27fd8080b517143cbbbab9dfb7c8571c40d67d534bbdee55bd6c473f432b177<br>Status: Downloaded newer image <span class="hljs-keyword">for</span> centos:latest<br>docker.io/library/centos:latest<br>从docker库拉去centos镜像<br>[root@docker ~]<span class="hljs-comment"># docker images</span><br>REPOSITORY   TAG       IMAGE ID       CREATED         SIZE<br>centos       latest    <span class="hljs-number">5</span>d0da3dc9764   <span class="hljs-number">18</span> months ago   <span class="hljs-number">231</span>MB<br><br></code></pre></td></tr></table></figure>

<h3 id="删除镜像"><a href="#删除镜像" class="headerlink" title="删除镜像"></a>删除镜像</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs powershell">docker rmi <span class="hljs-operator">-f</span> 镜像名/id		<span class="hljs-comment"># 删除指定镜像</span><br>docker rmi <span class="hljs-operator">-f</span> 镜像名<span class="hljs-number">1</span> 镜像名<span class="hljs-number">2</span> 镜像名<span class="hljs-number">3</span>	 <span class="hljs-comment"># 一次删除指定多个镜像</span><br>docker rmi <span class="hljs-operator">-f</span> <span class="hljs-variable">$</span>(docker images <span class="hljs-literal">-aq</span>)		<span class="hljs-comment"># 删除全部容器</span><br><br>[<span class="hljs-type">root</span>@<span class="hljs-type">docker</span> ~]<span class="hljs-comment"># docker images</span><br>REPOSITORY   TAG       IMAGE ID       CREATED         SIZE<br>centos       latest    <span class="hljs-number">5</span>d0da3dc9764   <span class="hljs-number">18</span> months ago   <span class="hljs-number">231</span>MB<br>[<span class="hljs-type">root</span>@<span class="hljs-type">docker</span> ~]<span class="hljs-comment"># docker rmi 5d0</span><br>Untagged: centos:latest<br>。。。。。。<br>（一般情况下 删除镜像id 只需要输入前面<span class="hljs-number">3</span>个字符就行了）<br></code></pre></td></tr></table></figure>

<h3 id="查看镜像分层"><a href="#查看镜像分层" class="headerlink" title="查看镜像分层"></a>查看镜像分层</h3><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">[root@docker ~]<span class="hljs-comment"># docker image inspect 镜像id</span><br></code></pre></td></tr></table></figure>

<h3 id="镜像资源包"><a href="#镜像资源包" class="headerlink" title="镜像资源包"></a>镜像资源包</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs awk">curl -O http:<span class="hljs-regexp">//mi</span>rrors.douxuedu.com<span class="hljs-regexp">/cloud/</span>docker.zip<br>unzip docker.zip<br>docker load &lt; 镜像名.tar<br>例如：<br>[root@localhost ~]<span class="hljs-comment"># docker load &lt; docker/centos_latest.tar</span><br></code></pre></td></tr></table></figure>

<h2 id="容器命令"><a href="#容器命令" class="headerlink" title="容器命令"></a>容器命令</h2><h3 id="新建容器并启动"><a href="#新建容器并启动" class="headerlink" title="新建容器并启动"></a>新建容器并启动</h3><figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker run [可选参数] 镜像名		<span class="hljs-comment"># 新建容器并启动</span><br>--name=Name		<span class="hljs-comment"># 容器名字用来区分容器</span><br>-d				<span class="hljs-comment"># 后台方式运行</span><br>-it				<span class="hljs-comment"># 使用交互方式运行，进入容器查看内容</span><br>-p				<span class="hljs-comment"># 指定容器的端口-p 8080:8080</span><br>-P				<span class="hljs-comment"># 随机指定端口</span><br>进入容器<br>[root@docker ~]<span class="hljs-comment"># docker run -it --name test centos</span><br>[root@<span class="hljs-number">4018</span>f9ac2f33 /]<span class="hljs-comment"># pwd</span><br>/<br><span class="hljs-keyword">exit</span>         <span class="hljs-comment"># 退出</span><br>Ctrl+P+Q     <span class="hljs-comment"># 容器不停止退出</span><br></code></pre></td></tr></table></figure>

<h3 id="查看容器列表"><a href="#查看容器列表" class="headerlink" title="查看容器列表"></a>查看容器列表</h3><figure class="highlight cmake"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><code class="hljs cmake">查看容器列表   （若加 -a可以查看所有容器包括为运行的）<br>[root@docker ~]<span class="hljs-comment"># docker ps [可选参数]</span><br>CONTAINER ID   IMAGE     <span class="hljs-keyword">COMMAND</span>       CREATED              STATUS              PORTS     NAMES<br><span class="hljs-number">4018</span>f9ac2f33   centos    <span class="hljs-string">&quot;/bin/bash&quot;</span>   About a minute ago   Up About a minute             <span class="hljs-keyword">test</span><br>[可选参数]<br>-a			<span class="hljs-comment"># 列出当前正在运行的容器+带出历史运行过的容器</span><br>-n=?		<span class="hljs-comment"># 显示最近创建的容器</span><br>-q			<span class="hljs-comment"># 只显示容器的编号</span><br></code></pre></td></tr></table></figure>

<h3 id="删除容器"><a href="#删除容器" class="headerlink" title="删除容器"></a>删除容器</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs powershell">（一般情况下 删除容器id 只需要输入前面<span class="hljs-number">3</span>个字符就行了）<br>docker <span class="hljs-built_in">rm</span> 容器id	<span class="hljs-comment"># 删除指定的容器，不能删除正在运行的容器，如果要强制删除 rm -f</span><br>docker <span class="hljs-built_in">rm</span> <span class="hljs-operator">-f</span> <span class="hljs-variable">$</span> (docker <span class="hljs-built_in">ps</span> <span class="hljs-literal">-aq</span>)		<span class="hljs-comment"># 强制删除所有的容器</span><br>docker <span class="hljs-built_in">ps</span> <span class="hljs-literal">-a</span> <span class="hljs-literal">-q</span>|xargs docker <span class="hljs-built_in">rm</span>		<span class="hljs-comment"># 删除所有的容器</span><br></code></pre></td></tr></table></figure>

<h3 id="启动和停止容器"><a href="#启动和停止容器" class="headerlink" title="启动和停止容器"></a>启动和停止容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">docker start 容器<span class="hljs-built_in">id</span>		<span class="hljs-comment"># 启动容器</span><br>docker restart 容器<span class="hljs-built_in">id</span>		<span class="hljs-comment"># 重启容器</span><br>docker stop 容器<span class="hljs-built_in">id</span>		<span class="hljs-comment"># 停止当前正在运行的容器</span><br>docker <span class="hljs-built_in">kill</span> 容器<span class="hljs-built_in">id</span>		<span class="hljs-comment"># 强制停止当前容器</span><br></code></pre></td></tr></table></figure>

<h3 id="进入正在运行的容器"><a href="#进入正在运行的容器" class="headerlink" title="进入正在运行的容器"></a>进入正在运行的容器</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs bash">进入容器后开启一个新的终端，可以在里面操作<br>docker <span class="hljs-built_in">exec</span> -it 容器<span class="hljs-built_in">id</span> /bin/bash<br>进入容器正在执行的终端，不会启动新的进程<br>docker attach 容器<span class="hljs-built_in">id</span><br></code></pre></td></tr></table></figure>

<h3 id="拷贝容器内的文件到主机上"><a href="#拷贝容器内的文件到主机上" class="headerlink" title="拷贝容器内的文件到主机上"></a>拷贝容器内的文件到主机上</h3><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><code class="hljs autoit">docker cp 容器id:容器内路径 目的主机路径<br><br>[root<span class="hljs-symbol">@docker</span> ~]<span class="hljs-meta"># docker exec -it 401 /bin/bash</span><br>[root<span class="hljs-symbol">@4018f9ac2f33</span> /]<span class="hljs-meta"># echo <span class="hljs-string">&quot;11&quot;</span> &gt; test.txt</span><br>[root<span class="hljs-symbol">@4018f9ac2f33</span> /]<span class="hljs-meta"># cat test.txt</span><br><span class="hljs-number">11</span><br>Ctrl+P+Q     <span class="hljs-meta"># 容器不停止退出</span><br>[root<span class="hljs-symbol">@docker</span> ~]<span class="hljs-meta"># docker cp 401:test.txt /root/</span><br>Preparing <span class="hljs-keyword">to</span> copy...<br>Successfully copied <span class="hljs-number">2.048</span>kB <span class="hljs-keyword">to</span> /root/<br>[root<span class="hljs-symbol">@docker</span> ~]<span class="hljs-meta"># cat test.txt</span><br><span class="hljs-number">11</span><br><br></code></pre></td></tr></table></figure>

<h3 id="停止容器，将容器打包成新镜像"><a href="#停止容器，将容器打包成新镜像" class="headerlink" title="停止容器，将容器打包成新镜像"></a>停止容器，将容器打包成新镜像</h3><figure class="highlight ldif"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs ldif">[root@docker ~]<span class="hljs-comment"># docker commit [可选参数] 容器id REPOSITORY:TAG</span><br>[可选参数]：<br><span class="hljs-literal">-</span>a :提交的镜像作者；<br><span class="hljs-literal">-</span>c :使用Dockerfile指令来创建镜像；<br><span class="hljs-literal">-</span>m :提交时的说明文字；<br><span class="hljs-literal">-</span>p :在commit时，将容器暂停。<br><br><br>[root@localhost ~]<span class="hljs-comment"># docker commit -a qianyios -m &quot;创建了test.txt&quot; 401 test/centos:v1</span><br><span class="hljs-attribute">sha256</span>:29ffb8423a78853c5a49918c99e8d513239f9c3365cca06e1fc0027f589b7f59<br>[root@localhost ~]<span class="hljs-comment"># docker images</span><br>REPOSITORY    TAG       IMAGE ID       CREATED         SIZE<br>test/centos   v1        29ffb8423a78   3 seconds ago   233MB<br>centos        latest    5d0da3dc9764   18 months ago   231MB<br><br></code></pre></td></tr></table></figure>

<h2 id="Docker数据卷"><a href="#Docker数据卷" class="headerlink" title="Docker数据卷"></a>Docker数据卷</h2><ul>
<li>数据卷用途：使容器内部的文件跟容器外面的文件同步</li>
<li>数据卷的特点:<ol>
<li>数据卷可在容器之间共享或重用数据</li>
<li>卷中的更改可以直接生效</li>
<li>数据卷中的更改不会包含在镜像的更新中</li>
<li>数据卷的生命周期一直持续到没有容器使用它为止</li>
</ol>
</li>
</ul>
<h3 id="数据卷基本命令"><a href="#数据卷基本命令" class="headerlink" title="数据卷基本命令"></a>数据卷基本命令</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">docker <span class="hljs-keyword">volume</span><span class="language-bash"> <span class="hljs-built_in">ls</span>		<span class="hljs-comment"># 查看所有挂载的数据卷</span></span><br>docker <span class="hljs-keyword">volume</span><span class="language-bash"> inspect 卷名	<span class="hljs-comment"># 查看数据卷所在的路径</span></span><br></code></pre></td></tr></table></figure>

<h3 id="指定路径挂载"><a href="#指定路径挂载" class="headerlink" title="指定路径挂载"></a>指定路径挂载</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-built_in">run</span> -v 主机目录:容器内目录<br></code></pre></td></tr></table></figure>

<h3 id="卷名挂载"><a href="#卷名挂载" class="headerlink" title="卷名挂载"></a>卷名挂载</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-built_in">run</span> -v 卷名(不是目录了):容器内 目录<br></code></pre></td></tr></table></figure>

<h3 id="匿名挂载"><a href="#匿名挂载" class="headerlink" title="匿名挂载"></a>匿名挂载</h3><figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-built_in">run</span> -v 容器内目录<br></code></pre></td></tr></table></figure>

<h3 id="数据卷权限"><a href="#数据卷权限" class="headerlink" title="数据卷权限"></a>数据卷权限</h3><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs applescript">docker <span class="hljs-built_in">run</span> -v 主机目录:容器内目录:ro		<span class="hljs-comment"># ro readonly 只读</span><br>docker <span class="hljs-built_in">run</span> -v 主机目录:容器内目录:rw		<span class="hljs-comment"># rw readwrite 可读可写</span><br><span class="hljs-comment"># ro只能在主机上面来操作目录，容器无法操作</span><br></code></pre></td></tr></table></figure>

<h3 id="数据卷容器"><a href="#数据卷容器" class="headerlink" title="数据卷容器"></a>数据卷容器</h3><figure class="highlight axapta"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs axapta">--volumes-<span class="hljs-keyword">from</span> 要同步文件的容器			<span class="hljs-meta"># 实现多个容器的数据同步与共享</span><br></code></pre></td></tr></table></figure>

<ul>
<li>例子：三个MySQL同步数据</li>
</ul>
<p>1、数据库1使用的命令</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker run -d -p 主机端口:<span class="hljs-number">3306</span> /<br>-v <span class="hljs-regexp">/etc/my</span>sql<span class="hljs-regexp">/conf.d -v /</span>var<span class="hljs-regexp">/1ib/my</span>sql /<br>-e MYSQL_ROOT_PASSWORD=数据库密码 --name mysql01 mysql<br></code></pre></td></tr></table></figure>

<p>2、数据库2使用的命令</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-built_in">run</span> -d -p 主机端口:3306 /<br>--volumes-from mysql01 /<br>-e <span class="hljs-attribute">MYSQL_ROOT_PASSWORD</span>=数据库密码 --name mysql02 mysql<br>Copy<br></code></pre></td></tr></table></figure>

<p>3、数据库3使用的命令</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs routeros">docker <span class="hljs-built_in">run</span> -d -p 主机端口:3306 /<br>--volumes-from mysql01 /<br>-e <span class="hljs-attribute">MYSQL_ROOT_PASSWORD</span>=数据库密码 --name mysql03 mysql<br></code></pre></td></tr></table></figure>

<h2 id="DockerFile"><a href="#DockerFile" class="headerlink" title="DockerFile"></a>DockerFile</h2><p>DockerFile是用来构建Docker镜像的构建文件。</p>
<h3 id="注意事项"><a href="#注意事项" class="headerlink" title="!注意事项"></a><span style="color:red">!</span>注意事项</h3><ul>
<li>1、每个保留关键字（指令）都是必须是大写字母</li>
<li>2、执行从上到下顺序执行</li>
<li>3、#表示注释</li>
<li>4、每一个指令都会创建提交一个新的镜像层，并提交</li>
</ul>
<img src="https://article.biliimg.com/bfs/article/2009e0e056c3fe3dbff4bae26643fd5eb7e965c6.png" srcset="/img/loading.gif" lazyload alt="image-20230325152651663" style="zoom: 50%;" />

<h3 id="DockerFile命令"><a href="#DockerFile命令" class="headerlink" title="DockerFile命令"></a>DockerFile命令</h3><figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile"><span class="hljs-keyword">FROM</span>          <span class="hljs-comment"># 基础镜镜像,—切从这里开始构建</span><br><span class="hljs-keyword">MAINTAINER</span>    <span class="hljs-comment"># 镜像的作者,姓名&lt;邮箱&gt;</span><br><span class="hljs-keyword">RUN</span><span class="language-bash">           <span class="hljs-comment"># 镜像构建的时候需要运行的命令</span></span><br><span class="hljs-keyword">ADD</span><span class="language-bash">           <span class="hljs-comment"># 添加内容，添加压缩包会自动解压</span></span><br><span class="hljs-keyword">WORKDIR</span><span class="language-bash">		 <span class="hljs-comment"># 镜像的工作目录</span></span><br><span class="hljs-keyword">VOLUME</span><span class="language-bash">        <span class="hljs-comment"># 挂载的目录</span></span><br><span class="hljs-keyword">EXPOSE</span>        <span class="hljs-comment"># 保留端口配置</span><br><span class="hljs-keyword">CMD</span><span class="language-bash">			<span class="hljs-comment"># 指定这个容器启动的时候要运行的命令,只有最后一个会生效，可被替代</span></span><br><span class="hljs-keyword">ENTRYPOINT</span><span class="language-bash">    <span class="hljs-comment"># 指定这个容器启动的时候要运行的命令,可以追加命令</span></span><br><span class="hljs-keyword">ONBUILD</span>		 <span class="hljs-comment"># 当构建一个被继承DockerFile这个时候就会运行ONBUILD 的指令。触发指令。</span><br><span class="hljs-keyword">COPY</span><span class="language-bash">          <span class="hljs-comment"># 类似ADD ，将我们文件拷贝到镜像中</span></span><br><span class="hljs-keyword">ENV</span>           <span class="hljs-comment"># 构建的时候设置环境变量!</span><br></code></pre></td></tr></table></figure>

<h3 id="用DockerFile文件创建镜像"><a href="#用DockerFile文件创建镜像" class="headerlink" title="用DockerFile文件创建镜像"></a>用DockerFile文件创建镜像</h3><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">docker <span class="hljs-keyword">build </span>-f DockerFile文件名 -t 镜像名:版本号 .<br><span class="hljs-comment"># -f指定Dockfile文件，若Dockerfile文件名就是Dockerfile，则不用-f再指定。系统则自动判定此文件是Dockerfile文件。</span><br><span class="hljs-comment"># 最后一个是 . 一定加上</span><br></code></pre></td></tr></table></figure>

<p>例子：</p>
<figure class="highlight dockerfile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><code class="hljs dockerfile">[root@docker ~]<span class="hljs-comment"># mkdir centos</span><br>[root@docker ~]<span class="hljs-comment"># cd centos/</span><br>[root@docker centos]<span class="hljs-comment"># touch DockerFile</span><br>[root@docker centos]<span class="hljs-comment"># vi DockerFile</span><br><span class="hljs-comment">#基础镜像信息</span><br><span class="hljs-keyword">FROM</span> centos:latest<br><span class="hljs-comment">#维护者信息</span><br><span class="hljs-keyword">MAINTAINER</span> qianyios xiaoohu2002@<span class="hljs-number">163</span>.com<br><span class="hljs-comment">#镜像操作指令</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> sed -i <span class="hljs-string">&#x27;s/mirrorlist/#mirrorlist/g&#x27;</span> /etc/yum.repos.d/CentOS-*</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> sed -i <span class="hljs-string">&#x27;s|#baseurl=http://mirror.centos.org|baseurl=http://vault.centos.org|g&#x27;</span> /etc/yum.repos.d/CentOS-*</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> yum install -y wget</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> wget -O /etc/yum.repos.d/CentOS-Base.repo https://mirrors.aliyun.com/repo/Centos-vault-8.5.2111.repo</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> yum clean all &amp;&amp; yum makecache</span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">mkdir</span> /test </span><br><span class="hljs-keyword">RUN</span><span class="language-bash"> <span class="hljs-built_in">echo</span> <span class="hljs-string">&#x27;test&#x27;</span> &gt; /test/test.txt</span><br><br>[root@docker centos]<span class="hljs-comment"># docker build -f /root/centos/DockerFile -t centos-test:v1 .</span><br>[root@docker centos]<span class="hljs-comment"># docker images</span><br>REPOSITORY    TAG       IMAGE ID       CREATED         SIZE<br>centos-test   v1        b1f4c91e59ee   <span class="hljs-number">2</span> minutes ago   <span class="hljs-number">328</span>MB<br><span class="hljs-comment">#此时已经有一个镜像了</span><br></code></pre></td></tr></table></figure>

<p>用这个镜像创建容器，且将容器中的&#x2F;test挂载到主机目录下的&#x2F;opt&#x2F;test</p>
<p>b1f是镜像id前三个字符</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs awk">docker run -it -v <span class="hljs-regexp">/opt/</span>test:<span class="hljs-regexp">/test --name test -p 80:80 b1f /</span>bin/bash<br><span class="hljs-keyword">exit</span><br>退出<span class="hljs-keyword">exit</span>之后查看<span class="hljs-regexp">/opt/</span>test是否有test.txt文件<br>[root@docker ~]<span class="hljs-comment"># cat /opt/test/test.txt</span><br>test<br>成功！！！<br></code></pre></td></tr></table></figure>

<h2 id="配置镜像加速器"><a href="#配置镜像加速器" class="headerlink" title="配置镜像加速器"></a>配置镜像加速器</h2><figure class="highlight nsis"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs nsis"><span class="hljs-comment"># 设置 Docker 镜像加速器</span><br>cat &gt; /etc/docker/daemon.json &lt;&lt; EOF<br>&#123;<br>  <span class="hljs-string">&quot;registry-mirrors&quot;</span>: [<br>    <span class="hljs-string">&quot;http://hub-mirror.c.163.com&quot;</span>,<br>    <span class="hljs-string">&quot;https://docker.mirrors.ustc.edu.cn/&quot;</span><br>  ],<br>  <span class="hljs-string">&quot;insecure-registries&quot;</span>: [],<br>  <span class="hljs-string">&quot;debug&quot;</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-string">&quot;experimental&quot;</span>: <span class="hljs-literal">false</span>,<br>  <span class="hljs-string">&quot;features&quot;</span>: &#123;<br>    <span class="hljs-string">&quot;buildkit&quot;</span>: <span class="hljs-literal">true</span><br>  &#125;<br>&#125;<br>EOF<br><br>sudo <span class="hljs-params">system</span>ctl daemon-reload<br>sudo <span class="hljs-params">system</span>ctl restart docker<br></code></pre></td></tr></table></figure>

<h2 id="Docker-网络"><a href="#Docker-网络" class="headerlink" title="Docker 网络"></a>Docker 网络</h2><p>docker网络主要是解决容器联网问题，也是我们使用容器中最重要的一个环节，如果容器没有网络则无法向网络中提供服务。</p>
<h3 id="网络管理命令：docker-network"><a href="#网络管理命令：docker-network" class="headerlink" title="网络管理命令：docker network"></a>网络管理命令：docker network</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs sql">[root<span class="hljs-variable">@docker</span> <span class="hljs-operator">~</span>]# docker network <span class="hljs-comment">--help</span><br>Usage:	docker network COMMAND<br>Manage networks<br>Commands:<br>  <span class="hljs-keyword">connect</span>        连接容器到网络<br>  <span class="hljs-keyword">create</span>          创建网络<br>  <span class="hljs-keyword">disconnect</span>    断开容器与网络的连接<br>  inspect         显示一个或多个网络的详细信息<br>  ls                 列表网络<br>  prune           删除所有未使用的网络<br>  rm               删除一个或多个网络<br></code></pre></td></tr></table></figure>

<h3 id="docker网络类型"><a href="#docker网络类型" class="headerlink" title="docker网络类型"></a>docker网络类型</h3><p>创建容器的时候可以通过—network命令来指定容器的网络，网络类型有以下四种</p>
<ul>
<li>bridge</li>
<li>host</li>
<li>none</li>
<li>容器网络或联盟网络</li>
</ul>
<h4 id="bridge"><a href="#bridge" class="headerlink" title="bridge"></a>bridge</h4><p>桥接网络是指容器通过桥接的方式将<strong>容器网卡</strong>桥接到<strong>宿主机的docker0网桥</strong>，然后在通过宿主机防火墙的NAT表实现与外网的联系。</p>
<h4 id="宿主机docker0网桥"><a href="#宿主机docker0网桥" class="headerlink" title="宿主机docker0网桥"></a>宿主机docker0网桥</h4><figure class="highlight pf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><code class="hljs pf">[root@docker ~]<span class="hljs-comment"># ifconfig </span><br><span class="hljs-comment">#docker0网桥</span><br>docker0: <span class="hljs-keyword">flags</span>=<span class="hljs-number">4163</span><span class="hljs-variable">&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;</span>  mtu <span class="hljs-number">1500</span><br>        <span class="hljs-keyword">inet</span> <span class="hljs-number">172.17</span>.<span class="hljs-number">0.1</span>  netmask <span class="hljs-number">255.255</span>.<span class="hljs-number">0.0</span>  broadcast <span class="hljs-number">172.17</span>.<span class="hljs-number">255.255</span><br>        <span class="hljs-keyword">inet6</span> fe80::<span class="hljs-number">42</span>:c7ff:fe37:<span class="hljs-number">8</span>e8  prefixlen <span class="hljs-number">64</span>  scopeid <span class="hljs-number">0</span>x20<span class="hljs-variable">&lt;link&gt;</span><br>        ether <span class="hljs-number">02</span>:<span class="hljs-number">42</span>:c7:<span class="hljs-number">37</span>:<span class="hljs-number">08</span>:e8  txqueuelen <span class="hljs-number">0</span>  (Ethernet)<br>        RX packets <span class="hljs-number">6618</span>  bytes <span class="hljs-number">277975</span> (<span class="hljs-number">271.4</span> KiB)<br>        RX errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span>  overruns <span class="hljs-number">0</span>  frame <span class="hljs-number">0</span><br>        TX packets <span class="hljs-number">8152</span>  bytes <span class="hljs-number">24675021</span> (<span class="hljs-number">23.5</span> MiB)<br>        TX errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span>  carrier <span class="hljs-number">0</span>  collisions <span class="hljs-number">0</span><br><br>.....省略了本机的网卡信息<br><span class="hljs-comment">#容器网卡，每创建一个桥接网络的容器就会生成一个对应的网卡</span><br>vethf75a942: <span class="hljs-keyword">flags</span>=<span class="hljs-number">4163</span><span class="hljs-variable">&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;</span>  mtu <span class="hljs-number">1500</span><br>        <span class="hljs-keyword">inet6</span> fe80::<span class="hljs-number">9085</span>:f5ff:fe34:<span class="hljs-number">77</span>b5  prefixlen <span class="hljs-number">64</span>  scopeid <span class="hljs-number">0</span>x20<span class="hljs-variable">&lt;link&gt;</span><br>        ether <span class="hljs-number">92</span>:<span class="hljs-number">85</span>:f5:<span class="hljs-number">34</span>:<span class="hljs-number">77</span>:b5  txqueuelen <span class="hljs-number">0</span>  (Ethernet)<br>        RX packets <span class="hljs-number">2850</span>  bytes <span class="hljs-number">158484</span> (<span class="hljs-number">154.7</span> KiB)<br>        RX errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span>  overruns <span class="hljs-number">0</span>  frame <span class="hljs-number">0</span><br>        TX packets <span class="hljs-number">3397</span>  bytes <span class="hljs-number">11613136</span> (<span class="hljs-number">11.0</span> MiB)<br>        TX errors <span class="hljs-number">0</span>  dropped <span class="hljs-number">0</span> overruns <span class="hljs-number">0</span>  carrier <span class="hljs-number">0</span>  collisions <span class="hljs-number">0</span><br>        <br>        <br>        <br>如果想看更清楚一下  可以使用  ip  add  show命令<br>[root@docker ~]<span class="hljs-comment"># ip add show</span><br><br><span class="hljs-number">4</span>: docker0: <span class="hljs-variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noqueue <span class="hljs-keyword">state</span> UP <span class="hljs-keyword">group</span> <span class="hljs-keyword">default</span> <br>    link/ether <span class="hljs-number">02</span>:<span class="hljs-number">42</span>:c7:<span class="hljs-number">37</span>:<span class="hljs-number">08</span>:e8 brd ff:ff:ff:ff:ff:ff<br>    <span class="hljs-keyword">inet</span> <span class="hljs-number">172.17</span>.<span class="hljs-number">0.1</span>/<span class="hljs-number">16</span> brd <span class="hljs-number">172.17</span>.<span class="hljs-number">255.255</span> scope <span class="hljs-keyword">global</span> docker0<br>       valid_lft forever preferred_lft forever<br>    <span class="hljs-keyword">inet6</span> fe80::<span class="hljs-number">42</span>:c7ff:fe37:<span class="hljs-number">8</span>e8/<span class="hljs-number">64</span> scope link <br>       valid_lft forever preferred_lft forever<br><br>容器网卡<br><span class="hljs-number">14</span>: vethf75a942@if13: <span class="hljs-variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noqueue master docker0 <span class="hljs-keyword">state</span> UP <span class="hljs-keyword">group</span> <span class="hljs-keyword">default</span> <br>    link/ether <span class="hljs-number">92</span>:<span class="hljs-number">85</span>:f5:<span class="hljs-number">34</span>:<span class="hljs-number">77</span>:b5 brd ff:ff:ff:ff:ff:ff link-netnsid <span class="hljs-number">1</span><br>    <span class="hljs-keyword">inet6</span> fe80::<span class="hljs-number">9085</span>:f5ff:fe34:<span class="hljs-number">77</span>b5/<span class="hljs-number">64</span> scope link <br>       valid_lft forever preferred_lft forever<br><br><br>注意：<br>这里的vethf75a942@if13指的就是容器网卡，V代表虚拟网卡的意思，eth 以太网卡，f75a942网卡编号，if13指的是宿主机网桥(docekr0)的一个端口，对应容器的网卡编号加一。<br>所以容器内的网卡编号应该是 eth0@if14<br><br>通过在容器中执行命令  ip add show 也可以看到<br>[root@docker ~]<span class="hljs-comment"># docker exec a5f ip add show</span><br><span class="hljs-number">1</span>: lo: <span class="hljs-variable">&lt;LOOPBACK,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">65536</span> qdisc noqueue <span class="hljs-keyword">state</span> UNKNOWN <span class="hljs-keyword">group</span> <span class="hljs-keyword">default</span> qlen <span class="hljs-number">1000</span><br>    link/loopback <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span> brd <span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span>:<span class="hljs-number">00</span><br>    <span class="hljs-keyword">inet</span> <span class="hljs-number">127.0</span>.<span class="hljs-number">0.1</span>/<span class="hljs-number">8</span> scope host lo<br>       valid_lft forever preferred_lft forever<br><span class="hljs-number">13</span>: eth0@if14: <span class="hljs-variable">&lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt;</span> mtu <span class="hljs-number">1500</span> qdisc noqueue <span class="hljs-keyword">state</span> UP <span class="hljs-keyword">group</span> <span class="hljs-keyword">default</span> <br>    link/ether <span class="hljs-number">02</span>:<span class="hljs-number">42</span>:ac:<span class="hljs-number">11</span>:<span class="hljs-number">00</span>:<span class="hljs-number">03</span> brd ff:ff:ff:ff:ff:ff link-netnsid <span class="hljs-number">0</span><br>    <span class="hljs-keyword">inet</span> <span class="hljs-number">172.17</span>.<span class="hljs-number">0.3</span>/<span class="hljs-number">16</span> brd <span class="hljs-number">172.17</span>.<span class="hljs-number">255.255</span> scope <span class="hljs-keyword">global</span> eth0<br>       valid_lft forever preferred_lft forever<br></code></pre></td></tr></table></figure>

<h4 id="防火墙的NAT表内容"><a href="#防火墙的NAT表内容" class="headerlink" title="防火墙的NAT表内容"></a>防火墙的NAT表内容</h4><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs vim">[root@docker ~]# iptables -t nat -L<br>Chain PREROUTING (policy ACCEPT)<br>target     prot <span class="hljs-keyword">opt</span> <span class="hljs-keyword">source</span>               destination         <br>DOCKER     <span class="hljs-keyword">all</span>  --  anywhere             anywhere             ADDRTYPE <span class="hljs-keyword">match</span> dst-<span class="hljs-built_in">type</span> LOCAL<br><br>Chain INPUT (policy ACCEPT)<br>target     prot <span class="hljs-keyword">opt</span> <span class="hljs-keyword">source</span>               destination         <br><br>Chain OUTPUT (policy ACCEPT)<br>target     prot <span class="hljs-keyword">opt</span> <span class="hljs-keyword">source</span>               destination         <br>DOCKER     <span class="hljs-keyword">all</span>  --  anywhere            !loopback/<span class="hljs-number">8</span>           ADDRTYPE <span class="hljs-keyword">match</span> dst-<span class="hljs-built_in">type</span> LOCAL<br><br>Chain POSTROUTING (policy ACCEPT)<br>target     prot <span class="hljs-keyword">opt</span> <span class="hljs-keyword">source</span>               destination         <br>MASQUERADE  <span class="hljs-keyword">all</span>  --  <span class="hljs-number">172.17</span>.<span class="hljs-number">0.0</span>/<span class="hljs-number">16</span>        anywhere            <br><br>Chain DOCKER (<span class="hljs-number">2</span> references)<br>target     prot <span class="hljs-keyword">opt</span> <span class="hljs-keyword">source</span>               destination         <br>RETURN     <span class="hljs-keyword">all</span>  --  anywhere             anywhere        <br></code></pre></td></tr></table></figure>

<h4 id="docker0-与容器网卡桥接"><a href="#docker0-与容器网卡桥接" class="headerlink" title="docker0 与容器网卡桥接"></a>docker0 与容器网卡桥接</h4><figure class="highlight mipsasm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs mipsasm">通过<span class="hljs-keyword">brctl </span><span class="hljs-keyword">show命令可以看到容器网卡和docker0网卡的桥接信息</span><br><span class="hljs-keyword"></span>[root@docker ~]<span class="hljs-comment"># brctl show</span><br><span class="hljs-keyword">bridge </span>name	<span class="hljs-keyword">bridge </span>id		STP enabled	interfaces<br>docker0		<span class="hljs-number">8000</span>.<span class="hljs-number">0242</span>c73708e8	no		vethf75a942<br></code></pre></td></tr></table></figure>

<p><strong>创建一个网络为bridge类型的容器，不指定默认也是这个类型</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs css"><span class="hljs-selector-attr">[root@docker ~]</span># docker run -d <span class="hljs-attr">--network</span> bridge <span class="hljs-attr">--name</span> centos1 baishuming2020/centos_nginx<br></code></pre></td></tr></table></figure>

<h3 id="host"><a href="#host" class="headerlink" title="host"></a>host</h3><p><strong>容器和真机共用网卡及对应的端口，缺点就是同一个端口只能宿主机或者某个容器使用，其他容器不能用。</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">创建一个网络类型host的容器<br><span class="hljs-selector-attr">[root@docker ~]</span># docker run -d <span class="hljs-attr">--network</span> host <span class="hljs-attr">--name</span> centos2 baishuming2020/centos_nginx<br></code></pre></td></tr></table></figure>

<h3 id="none"><a href="#none" class="headerlink" title="none"></a>none</h3><p><strong>容器仅有lo网卡，是一个不能联网的本地容器</strong></p>
<figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs css">创建一个网络类型为lo的容器<br><span class="hljs-selector-attr">[root@docker ~]</span># docker run -d <span class="hljs-attr">--network</span> <span class="hljs-attribute">none</span> <span class="hljs-attr">--name</span> centos3 baishuming2020/centos_nginx<br></code></pre></td></tr></table></figure>

<h3 id="实现网桥网络"><a href="#实现网桥网络" class="headerlink" title="实现网桥网络"></a>实现网桥网络</h3><p>目的：不同的服务容器组应用不同的网桥，避免同一网络内容器太多，保持容器网络独立性。</p>
<p>关于新网桥联网问题：创建网桥后，宿主机会自动帮你做NAT，所以不用担心联网问题</p>
<h4 id="查看网络-ls"><a href="#查看网络-ls" class="headerlink" title="查看网络-ls"></a>查看网络-ls</h4><figure class="highlight sqf"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><code class="hljs sqf">[root@docker ~]<span class="hljs-meta"># docker network ls</span><br>NETWORK ID          <span class="hljs-built_in">NAME</span>                <span class="hljs-built_in">DRIVER</span>              SCOPE<br><span class="hljs-number">80982</span>d2613cd        bridge              bridge              <span class="hljs-built_in">local</span><br><span class="hljs-number">40</span>c179ab420a        docker1             bridge              <span class="hljs-built_in">local</span><br><span class="hljs-number">04</span>aadb7475c0        docker100           bridge              <span class="hljs-built_in">local</span><br>ce79e9d7525a        host                host                <span class="hljs-built_in">local</span><br><span class="hljs-number">8</span>f0358469e57        none                null                <span class="hljs-built_in">local</span><br><br>NETWORK ID     网桥ID   <br><span class="hljs-built_in">NAME</span>          	 名称<br><span class="hljs-built_in">DRIVER</span>        	 网络类型  <br>SCOPE	   	   作用范围<br></code></pre></td></tr></table></figure>

<h4 id="创建网桥-create"><a href="#创建网桥-create" class="headerlink" title="创建网桥-create"></a>创建网桥-create</h4><figure class="highlight golo"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs golo">[root<span class="hljs-meta">@docker</span> ~]<span class="hljs-comment"># docker network create -d bridge --subnet 192.168.148.0/24 --gateway 192.168.148.2 a1</span><br><span class="hljs-number">6</span>a410e27b66ea587142d967f7dff6f36c04ced3c27116a79831412f3743aba56<br><br>[root<span class="hljs-meta">@docker</span> ~]<span class="hljs-comment"># docker network ls</span><br>NETWORK ID          NAME                DRIVER              SCOPE<br><span class="hljs-number">6</span>ee1e928b710        bridge              bridge              <span class="hljs-keyword">local</span><br>ce79e9d7525a        host                host                <span class="hljs-keyword">local</span><br><span class="hljs-number">6</span>a410e27b66e        mydocker0           bridge              <span class="hljs-keyword">local</span><br><span class="hljs-number">8</span>f0358469e57        none                <span class="hljs-literal">null</span>                <span class="hljs-keyword">local</span><br><br><br>修改docker网桥名字<br><span class="hljs-number">1</span>、修改名字<br>[root<span class="hljs-meta">@docker</span> ~]<span class="hljs-comment"># docker network rename old_name new_name</span><br><span class="hljs-number">2</span>、重启docker服务<br>[root<span class="hljs-meta">@docker</span> ~]<span class="hljs-comment"># systemctl restart docker</span><br></code></pre></td></tr></table></figure>

<h4 id="删除未使用的网桥-prune"><a href="#删除未使用的网桥-prune" class="headerlink" title="删除未使用的网桥-prune"></a>删除未使用的网桥-prune</h4><figure class="highlight applescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs applescript">[root@docker ~]<span class="hljs-comment"># docker network prune </span><br>WARNING! This will remove all networks <span class="hljs-keyword">not</span> used <span class="hljs-keyword">by</span> <span class="hljs-keyword">at</span> least one container.<br>Are you sure you want <span class="hljs-keyword">to</span> <span class="hljs-keyword">continue</span>? [y/N] y<br>Deleted Networks:<br>docker1<br></code></pre></td></tr></table></figure>

<h4 id="删除某个网桥-rm"><a href="#删除某个网桥-rm" class="headerlink" title="删除某个网桥-rm"></a>删除某个网桥-rm</h4><figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs autoit">[root<span class="hljs-symbol">@docker</span> ~]<span class="hljs-meta"># docker network rm docker100</span><br>docker100<br><br>注意：<br>不能被活动容器占用<br></code></pre></td></tr></table></figure>

<h4 id="容器连接到网桥"><a href="#容器连接到网桥" class="headerlink" title="容器连接到网桥"></a>容器连接到网桥</h4><p>前提是该容器是桥接网络</p>
<figure class="highlight tap"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs tap">docker network connect 网卡 容器<br>[root@docker ~]<span class="hljs-comment"># docker network connect docker1 centos1</span><br>[root@docker ~]<span class="hljs-comment"># docker exec centos1 ifconfig</span><br>eth0: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 172.17.0.2  netmask 255.255.0.0  broadcast 172.17.255.255<br>        ether 02:42:ac:11:00:02  txqueuelen<span class="hljs-number"> 0 </span> (Ethernet)<br>        RX packets<span class="hljs-number"> 8 </span> bytes<span class="hljs-number"> 656 </span>(656.0 B)<br>        RX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span> overruns<span class="hljs-number"> 0 </span> frame 0<br>        TX packets<span class="hljs-number"> 0 </span> bytes<span class="hljs-number"> 0 </span>(0.0 B)<br>        TX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span>overruns<span class="hljs-number"> 0 </span> carrier<span class="hljs-number"> 0 </span> collisions 0<br>发现centos1容器多了一块网卡，使用的正是docker1的网段<br>eth1: flags=4163&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu 1500<br>        inet 192.168.1.2  netmask 255.255.255.0  broadcast 192.168.1.255<br>        ether 02:42:c0:a8:01:02  txqueuelen<span class="hljs-number"> 0 </span> (Ethernet)<br>        RX packets<span class="hljs-number"> 16 </span> bytes<span class="hljs-number"> 1312 </span>(1.2 KiB)<br>        RX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span> overruns<span class="hljs-number"> 0 </span> frame 0<br>        TX packets<span class="hljs-number"> 0 </span> bytes<span class="hljs-number"> 0 </span>(0.0 B)<br>        TX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span>overruns<span class="hljs-number"> 0 </span> carrier<span class="hljs-number"> 0 </span> collisions 0<br><br>lo: flags=73&lt;UP,LOOPBACK,RUNNING&gt;  mtu 65536<br>        inet 127.0.0.1  netmask 255.0.0.0<br>        loop  txqueuelen<span class="hljs-number"> 1000 </span> (Local Loopback)<br>        RX packets<span class="hljs-number"> 0 </span> bytes<span class="hljs-number"> 0 </span>(0.0 B)<br>        RX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span> overruns<span class="hljs-number"> 0 </span> frame 0<br>        TX packets<span class="hljs-number"> 0 </span> bytes<span class="hljs-number"> 0 </span>(0.0 B)<br>        TX errors<span class="hljs-number"> 0 </span> dropped<span class="hljs-number"> 0 </span>overruns<span class="hljs-number"> 0 </span> carrier<span class="hljs-number"> 0 </span> collisions 0<br></code></pre></td></tr></table></figure>

<h4 id="容器断开网桥"><a href="#容器断开网桥" class="headerlink" title="容器断开网桥"></a>容器断开网桥</h4><figure class="highlight coffeescript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs coffeescript">将centos1容器的网络从docker1网桥断开<br>[root@docker ~]<span class="hljs-comment"># docker network disconnect docker1 centos1</span><br></code></pre></td></tr></table></figure>

<h3 id="常见故障"><a href="#常见故障" class="headerlink" title="常见故障"></a>常见故障</h3><h4 id="FAQ1：使用改名后的新网桥的容器可能无法解析域名"><a href="#FAQ1：使用改名后的新网桥的容器可能无法解析域名" class="headerlink" title="FAQ1：使用改名后的新网桥的容器可能无法解析域名"></a>FAQ1：使用改名后的新网桥的容器可能无法解析域名</h4><p>原因：没有配置新网桥的DNS</p>
<p>解决方法：为容器手动配置一个DNS地址即可</p>
<h4 id="FAQ2：Networking-will-not-work"><a href="#FAQ2：Networking-will-not-work" class="headerlink" title="FAQ2：Networking will not work"></a>FAQ2：Networking will not work</h4><figure class="highlight asciidoc"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs asciidoc">[root@docker ~]# docker run -d --network docker100 --name centos4 baishuming2020/centos_nginx<br><span class="hljs-symbol">WARNING: </span>IPv4 forwarding is disabled. Networking will not work.<br>67f2c276123c993cd66b9d7a99ba22402331a13f9ea8817e57324a934896b805<br><br>解决方案<br>1、打开转发<br>[root@docker ~]# echo &quot;net.ipv4.ip_forward=1&quot; &gt;&gt;  /usr/lib/sysctl.d/00-system.conf<br><br>2、重启网络<br>[root@docker ~]# systemctl restart network<br></code></pre></td></tr></table></figure>

<h3 id="不同主机间的容器通信"><a href="#不同主机间的容器通信" class="headerlink" title="不同主机间的容器通信"></a>不同主机间的容器通信</h3><h4 id="macvlan"><a href="#macvlan" class="headerlink" title="macvlan"></a>macvlan</h4><p>在 Docker 中，macvlan 是众多 Docker 网络模型中的一种，并且是一种跨主机的网络模型，作为一种驱动启用，Docker macvlan 只支持 bridge 模式</p>
<figure class="highlight routeros"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs routeros"><span class="hljs-comment">#macvlan 需要一块独立的网卡来进行使用，所以我们需要新添加一块网卡</span><br><br>docker<span class="hljs-built_in"> network </span>create -d macvlan <span class="hljs-attribute">--subnet</span>=172.16.10.0/24 <span class="hljs-attribute">--gateway</span>=172.16.10.1  -o <span class="hljs-attribute">parent</span>=ens224  mtacvlan-1<br><br>-o <span class="hljs-attribute">parent</span>=网卡名称  指定用来给 macvlan 网络使用的物理网卡<br><br>注意，要在所有需要运行 macvlan 的主机上执行这条命令，但是要记得更改网关的地址，避免造成IP冲突<br><br>docker <span class="hljs-built_in">run</span> -itd --network macvlan-1 centos /bin/bash<br></code></pre></td></tr></table></figure>

<h4 id="overlay"><a href="#overlay" class="headerlink" title="overlay"></a>overlay</h4><p>在 Docker 中，overlay 是众多 Docker 网络模型中的一种，并且是一种跨主机的全局网络模型，有一个数据库专门的来存储网络分配信息，避免 IP 冲突，同时内部还有一个小型的 DNS 我们可以直接通过主机名进行访问</p>
<figure class="highlight pgsql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs pgsql">consul 服务端：<br>docker run -itd -h consul <span class="hljs-comment">--name consul --restart=always -p 8500:8500 progrium/consul -server -bootstrap</span><br><br>-h 				主机名<br>–<span class="hljs-type">name</span> 			容器名<br>–<span class="hljs-keyword">restart</span>=<span class="hljs-keyword">always</span> 重启策略<br>progrium/consul 镜像名称<br>-<span class="hljs-keyword">server</span> 		以服务节点启动<br>-bootstrap		预期的启动节点数：自举<br><br>在浏览器内输入 IP地址+端口号 可以看到 web 页面<br><br>在所有主机上编辑 daemon.json 文件：<br>&#123;<br>&quot;hosts&quot;: [&quot;tcp://0.0.0.0:2375&quot;,&quot;unix:///var/run/docker.sock&quot;]， 监听相关端口<br>&quot;cluster-store&quot;:&quot;consul://192.168.1.150:8500&quot;,		   集群的主机地址<br>&quot;cluster-advertise&quot;:&quot;192.168.1.150:2375”		宣告自己的地址 <br>&#125;<br><br>重启 docker 服务<br><br>创建 overlay 网络（全局网络）：一台主机上创建自动同步<br><br>	docker network create -d overlay overlay-1<br><br>启动容器测试：<br><br>	docker run -it --name docker-1 --network=overlay-1 centos /bin/bash<br>	<br>	docker run -it --name docker-2 --network=overlay-1 centos /bin/bash<br>	<br>验证：ping docker-1<br></code></pre></td></tr></table></figure>

<h3 id="常见故障-1"><a href="#常见故障-1" class="headerlink" title="常见故障"></a>常见故障</h3><p>如发现各容器内分配的ip之间相互ping不通</p>
<figure class="highlight graphql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs graphql">原因：可能由于防火墙问题引起的,默认forward链是drop状态，需要打开才可以<br><br><br>解决方案<span class="hljs-punctuation">:</span><br>执行下面操作，保证<span class="hljs-keyword">INPUT</span>  FORWARD链都是ACCEPT状态<br>清除其他规则<br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node1</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -P INPUT ACCEPT</span><br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node1</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -P FORWARD ACCEPT</span><br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node1</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -F</span><br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node1</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -L -n</span><br><br><br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node2</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -P INPUT ACCEPT</span><br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node2</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -P FORWARD ACCEPT</span><br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node2</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -F</span><br><span class="hljs-punctuation">[</span>root<span class="hljs-meta">@docker_node2</span> ~<span class="hljs-punctuation">]</span><span class="hljs-comment"># iptables -L -n</span><br></code></pre></td></tr></table></figure>

<h2 id="Docker私有仓库"><a href="#Docker私有仓库" class="headerlink" title="Docker私有仓库"></a>Docker私有仓库</h2><p>在Docker中，当我们执行 docker pull xxx 的时候 ，它实际上是从 hub.docker.com 这个地址去查找，这就是 Docker 公司为我们提供的公共仓库。在工作中，我们不可能把企业项目 push 到公有仓库进行管理。所以为了更好的管理镜像，Docker 不仅提供了一个中央仓库，同时也允许我们搭建本地私有仓库。</p>
<p>docker容器镜像仓库分类：</p>
<ul>
<li>公网仓库：docker hub</li>
<li>私网仓库: registry、harbor</li>
</ul>
<h3 id="部署步骤"><a href="#部署步骤" class="headerlink" title="部署步骤"></a>部署步骤</h3><p>拉取registry镜像</p>
<figure class="highlight ebnf"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs ebnf"><span class="hljs-attribute">docker pull registry</span> <br></code></pre></td></tr></table></figure>

<p>创建registry仓库容器</p>
<figure class="highlight awk"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><code class="hljs awk"><span class="hljs-number">1</span>、创建持久化存储，将容器镜像存储目录<span class="hljs-regexp">/var/</span>lib/registry<br>挂载到本地<span class="hljs-regexp">/opt/</span>qyck下：<br><br>mkdir <span class="hljs-regexp">/opt/</span>qyck<br><br><span class="hljs-number">2</span>、创建 registry 容器：<br><br>docker run -itd -p <span class="hljs-number">5000</span>:<span class="hljs-number">5000</span> \<br>-v <span class="hljs-regexp">/opt/</span>qyck:<span class="hljs-regexp">/var/</span>lib/registry  \<br>--restart=always registry:latest<br><br><span class="hljs-number">3</span>、查看容器是否运行<br>[root@qyck ~]<span class="hljs-comment"># docker ps</span><br>CONTAINER ID   IMAGE             COMMAND                  CREATED          STATUS         PORTS                                       NAMES<br>d1ea79cc023f   registry:latest   <span class="hljs-string">&quot;/entrypoint.sh /etc…&quot;</span>   <span class="hljs-number">10</span> seconds ago   Up <span class="hljs-number">9</span> seconds   <span class="hljs-number">0.0</span>.<span class="hljs-number">0.0</span>:<span class="hljs-number">5000</span>-&gt;<span class="hljs-number">5000</span><span class="hljs-regexp">/tcp, :::5000-&gt;5000/</span>tcp   trusting_gates<br><br></code></pre></td></tr></table></figure>

<p>测试容器应用</p>
<figure class="highlight elixir"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs elixir">[root<span class="hljs-variable">@zutuanxue_manage01</span> ~]<span class="hljs-comment"># curl 192.168.48.128:5000/v2/_catalog</span><br>&#123;<span class="hljs-string">&quot;repositories&quot;</span><span class="hljs-symbol">:[]</span>&#125;<br><br>显示仓库中没有任何镜像<br></code></pre></td></tr></table></figure>

<h3 id="上传镜像"><a href="#上传镜像" class="headerlink" title="上传镜像"></a>上传镜像</h3><p>测试：拉取nginx镜像</p>
<figure class="highlight crmsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs crmsh">docker pull nginx<br>[root@qyck ~]<span class="hljs-comment"># docker images</span><br>REPOSITORY   <span class="hljs-keyword">TAG</span>       <span class="hljs-title">IMAGE</span> ID       CREATED       SIZE<br>registry     latest    <span class="hljs-number">65</span>f3b3441f04   <span class="hljs-number">9</span> days ago    <span class="hljs-number">24M</span>B<br>nginx        latest    <span class="hljs-number">448</span>a08f1d2f9   <span class="hljs-number">2</span> weeks ago   <span class="hljs-number">142M</span>B<br><br></code></pre></td></tr></table></figure>

<p>设置docker仓库为registry本地仓库</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><code class="hljs gradle">#<span class="hljs-number">1</span>、修改docker进程启动文件，修改其启动方式，目的是为了让通过docker配置文件启动<br>[root@qyck ~]# sed -i.bak <span class="hljs-string">&#x27;/^ExecStart=/c\ExecStart=\/usr\/bin\/dockerd&#x27;</span> <span class="hljs-regexp">/usr/</span>lib<span class="hljs-regexp">/systemd/</span>system/docker.service<br><br>#<span class="hljs-number">2</span>、设置docker 守护进程的配置文件 <span class="hljs-regexp">/etc/</span>docker/daemon.json,默认没有该文件<br>[root@qyck ~]# cat <span class="hljs-regexp">/etc/</span>docker/daemon.json <br>&#123;<br> <span class="hljs-string">&quot;insecure-registries&quot;</span>: [<span class="hljs-string">&quot;http://192.168.48.128:5000&quot;</span>]<br>&#125;<br><br>insecure-registries 指定非安全的仓库地址，多个用逗号隔开<br><br>#<span class="hljs-number">3</span>、重启docker生效配置文件<br>systemctl daemon-reload<br>systemctl restart docker<br></code></pre></td></tr></table></figure>

<p>将镜像打tag</p>
<figure class="highlight accesslog"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs accesslog"><span class="hljs-string">[root@qyck ~]</span># docker tag nginx:latest <span class="hljs-number">192</span>.<span class="hljs-number">168</span>.<span class="hljs-number">48</span>.<span class="hljs-number">128</span>:<span class="hljs-number">5000</span>/nginx:v1<br><span class="hljs-string">[root@qyck ~]</span># docker images<br>REPOSITORY                  TAG       IMAGE ID       CREATED       SIZE<br><span class="hljs-number">192.168.48.128:5000</span>/nginx   v1        448a08f1d2f9   <span class="hljs-number">2</span> weeks ago   142MB<br></code></pre></td></tr></table></figure>

<p>推送镜像到仓库</p>
<figure class="highlight gradle"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs gradle">[root@qyck ~]# docker <span class="hljs-keyword">push</span> <span class="hljs-number">192.168</span>.<span class="hljs-number">48.128</span>:<span class="hljs-number">5000</span>/nginx:v1<br>The <span class="hljs-keyword">push</span> refers to repository [<span class="hljs-number">192.168</span>.<span class="hljs-number">48.128</span>:<span class="hljs-number">5000</span>/nginx]<br><span class="hljs-number">1040838</span>fe30e: Pushed<br><span class="hljs-number">93</span>ee76f39c97: Pushed<br><span class="hljs-number">5684</span>be535bf1: Pushed<br><span class="hljs-number">6</span>bc8ae8fb3cf: Pushed<br>a29cc9587af6: Pushed<br><span class="hljs-number">8553</span>b91047da: Pushed<br>v1: digest: sha256:<span class="hljs-number">3</span>f01b0094e21f7d55b9eb7179d01c49fdf9c3e1e3419d315b81a9e0bae1b6a90 <span class="hljs-keyword">size</span>: <span class="hljs-number">1570</span><br><br><br>#<span class="hljs-number">2</span>、查看上传<br>[root@qyck ~]# curl http:<span class="hljs-comment">//192.168.48.128:5000/v2/_catalog</span><br>&#123;<span class="hljs-string">&quot;repositories&quot;</span>:[<span class="hljs-string">&quot;nginx&quot;</span>]&#125;<br><br>#查看存储文件夹<br>[root@qyck ~]# ls <span class="hljs-regexp">/opt/</span>qyck<span class="hljs-regexp">/docker/</span>registry<span class="hljs-regexp">/v2/</span><span class="hljs-keyword">repositories</span>/<br>nginx<br><br></code></pre></td></tr></table></figure>

<h3 id="拉取镜像-1"><a href="#拉取镜像-1" class="headerlink" title="拉取镜像"></a>拉取镜像</h3><p>在另外一台机拉取nginx镜像</p>
<figure class="highlight autoit"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><code class="hljs autoit"><span class="hljs-meta">#1、设置docker启动文件</span><br>[root<span class="hljs-symbol">@zutuanxue_node1</span> ~]<span class="hljs-meta"># sed -i.bak <span class="hljs-string">&#x27;/^ExecStart=/c\ExecStart=\/usr\/bin\/dockerd&#x27;</span> /usr/lib/systemd/system/docker.service</span><br><br><span class="hljs-meta">#2、设置docker配置文件</span><br>[root<span class="hljs-symbol">@zutuanxue_node1</span> ~]<span class="hljs-meta"># cat  /etc/docker/daemon.json </span><br>&#123;<br> <span class="hljs-string">&quot;insecure-registries&quot;</span>: [<span class="hljs-string">&quot;http://192.168.48.128:5000&quot;</span>]<br>&#125;<br><br>systemctl daemon-reload<br>systemctl restart docker<br></code></pre></td></tr></table></figure>

<p>拉取镜像</p>
<figure class="highlight makefile"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs makefile">[root@qyck ~]<span class="hljs-comment"># docker pull 192.168.48.128:5000/nginx:v1</span><br><span class="hljs-section">v1: Pulling from nginx</span><br><span class="hljs-section">9e3ea8720c6d: Pull complete</span><br><span class="hljs-section">bf36b6466679: Pull complete</span><br><span class="hljs-section">15a97cf85bb8: Pull complete</span><br><span class="hljs-section">9c2d6be5a61d: Pull complete</span><br><span class="hljs-section">6b7e4a5c7c7a: Pull complete</span><br><span class="hljs-section">8db4caa19df8: Pull complete</span><br><span class="hljs-section">Digest: sha256:3f01b0094e21f7d55b9eb7179d01c49fdf9c3e1e3419d315b81a9e0bae1b6a90</span><br><span class="hljs-section">Status: Downloaded newer image for 192.168.48.128:5000/nginx:v1</span><br><span class="hljs-section">192.168.48.128:5000/nginx:v1</span><br>[root@qyck ~]<span class="hljs-comment"># docker images</span><br>REPOSITORY                  TAG       IMAGE ID       CREATED       SIZE<br>registry                    latest    65f3b3441f04   9 days ago    24MB<br><span class="hljs-section">192.168.48.128:5000/nginx   v1        448a08f1d2f9   2 weeks ago   142MB</span><br><br><br></code></pre></td></tr></table></figure>



<h2 id="Docker学习总结"><a href="#Docker学习总结" class="headerlink" title="Docker学习总结"></a>Docker学习总结</h2><p><img src="https://article.biliimg.com/bfs/article/f8242ed25c3cc4a0f16a604d1d53b5f885684b49.png" srcset="/img/loading.gif" lazyload alt="1"></p>
<h2 id="docker-run-参数解析"><a href="#docker-run-参数解析" class="headerlink" title="docker run 参数解析"></a>docker run 参数解析</h2><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><code class="hljs stylus">-d: 后台运行容器，并返回容器ID；<br><br>-<span class="hljs-selector-tag">i</span>: 以交互模式运行容器，通常与 -t 同时使用；<br><br>-P: 随机端口映射，容器内部端口随机映射到主机的端口<br><br>-<span class="hljs-selector-tag">p</span>: 指定端口映射，格式为：主机(宿主)端口:容器端口<br><br>-t: 为容器重新分配一个伪输入终端，通常与 -<span class="hljs-selector-tag">i</span> 同时使用；<br><br><span class="hljs-attr">--name</span>=<span class="hljs-string">&quot;nginx-lb&quot;</span>: 为容器指定一个名称；<br><br><span class="hljs-attr">--dns</span> <span class="hljs-number">8.8</span>.<span class="hljs-number">8.8</span>: 指定容器使用的DNS服务器，默认和宿主一致；<br><br><span class="hljs-attr">--dns-search</span> example<span class="hljs-selector-class">.com</span>: 指定容器DNS搜索域名，默认和宿主一致；<br><br>-h <span class="hljs-string">&quot;mars&quot;</span>: 指定容器的hostname；<br><br>-e username=<span class="hljs-string">&quot;ritchie&quot;</span>: 设置环境变量；<br><br><span class="hljs-attr">--env-file</span>=<span class="hljs-selector-attr">[]</span>: 从指定文件读入环境变量；<br><br><span class="hljs-attr">--cpuset</span>=<span class="hljs-string">&quot;0-2&quot;</span> or <span class="hljs-attr">--cpuset</span>=<span class="hljs-string">&quot;0,1,2&quot;</span>: 绑定容器到指定CPU运行；<br><br>-m :设置容器使用内存最大值；<br><br><span class="hljs-attr">--net</span>=<span class="hljs-string">&quot;bridge&quot;</span>: 指定容器的网络连接类型，支持 bridge/host/<span class="hljs-attribute">none</span>/container: 四种类型；<br><br><span class="hljs-attr">--link</span>=<span class="hljs-selector-attr">[]</span>: 添加链接到另一个容器；<br><br><span class="hljs-attr">--expose</span>=<span class="hljs-selector-attr">[]</span>: 开放一个端口或一组端口；<br><br><span class="hljs-attr">--volume</span> , -v: 绑定一个卷<br></code></pre></td></tr></table></figure>



<p>此笔记参考 <a target="_blank" rel="noopener" href="https://blog.kbai.cc/">开摆工作室</a>&#x2F;<a target="_blank" rel="noopener" href="https://blog.kbai.cc/2022/04/25/Docker%20%E5%9F%BA%E7%A1%80/#%F0%9F%9A%80Docker%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80%E6%80%BB%E7%BB%93">Docker基础</a>精心整理</p>
<div class="tbsm" style="margin-top:54px;">
<div class="tbsm-top"><span><svg t="1674654360507" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="987" data-spm-anchor-id="a313x.7781069.0.i0" width="35" height="35"><path d="M410.49 97.74H155.08a56.74 56.74 0 0 0-56.84 56.73V410a56.84 56.84 0 0 0 56.84 56.84h255.41A56.83 56.83 0 0 0 467.32 410V154.58a56.83 56.83 0 0 0-56.83-56.84zM410.49 558.74H155.08a56.74 56.74 0 0 0-56.84 56.73V871a56.84 56.84 0 0 0 56.84 56.84h255.41A56.83 56.83 0 0 0 467.32 871V615.58a56.83 56.83 0 0 0-56.83-56.84zM871.49 558.74H616.08a56.74 56.74 0 0 0-56.84 56.73V871a56.84 56.84 0 0 0 56.84 56.84h255.41A56.83 56.83 0 0 0 928.32 871V615.58a56.83 56.83 0 0 0-56.83-56.84z" fill="#66EEFF" p-id="988"></path><path d="M410.49 558.74h-4.14A475 475 0 0 0 299.52 859.6a481.16 481.16 0 0 0 4.84 68.22h106.13A56.83 56.83 0 0 0 467.32 871V615.58a56.83 56.83 0 0 0-56.83-56.84zM871.49 558.74H616.08a56.74 56.74 0 0 0-56.84 56.73V871a56.84 56.84 0 0 0 56.84 56.84h255.41A56.83 56.83 0 0 0 928.32 871V615.58a56.83 56.83 0 0 0-56.83-56.84z" fill="#C2F8FF" p-id="989"></path></svg></span><span style="font-size:30px;"> 特别声明</span></div>
<div class="tbsm-wz">千屹博客旗下的所有文章，是通过本人课堂学习和课外自学所精心整理的知识巨著<br/>难免会有出错的地方<br/>如果细心的你发现了小失误，可以在下方评论区告诉我，或者私信我！<br />非常感谢大家的热烈支持！</div>
</div>
                
              </div>
            
            <hr/>
            <div>
              <div class="post-metas my-3">
  
  
    <div class="post-meta">
      <i class="iconfont icon-tags"></i>
      
        <a href="/tags/Docker/">#Docker</a>
      
    </div>
  
</div>


              
  

  <div class="license-box my-3">
    <div class="license-title">
      <div>Docker笔记</div>
      <div>https://blog.qianyios.top/2023/03/26/Docker node/</div>
    </div>
    <div class="license-meta">
      
        <div class="license-meta-item">
          <div>作者</div>
          <div>严千屹</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>发布于</div>
          <div>2023年3月26日</div>
        </div>
      
      
        <div class="license-meta-item license-meta-date">
          <div>更新于</div>
          <div>2023年7月8日</div>
        </div>
      
      
        <div class="license-meta-item">
          <div>许可协议</div>
          <div>
            
              
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
                  <span class="hint--top hint--rounded" aria-label="BY - 署名">
                    <i class="iconfont icon-by"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
                  <span class="hint--top hint--rounded" aria-label="NC - 非商业性使用">
                    <i class="iconfont icon-nc"></i>
                  </span>
                </a>
              
                <a target="_blank" href="https://creativecommons.org/licenses/by-nc-nd/4.0/">
                  <span class="hint--top hint--rounded" aria-label="ND - 禁止演绎">
                    <i class="iconfont icon-nd"></i>
                  </span>
                </a>
              
            
          </div>
        </div>
      
    </div>
    <div class="license-icon iconfont"></div>
  </div>



              
                <div class="post-prevnext my-3">
                  <article class="post-prev col-6">
                    
                    
                      <a href="/2023/04/02/OpenStackT/" title="OpenStack-Train双节点部署">
                        <i class="iconfont icon-arrowleft"></i>
                        <span class="hidden-mobile">OpenStack-Train双节点部署</span>
                        <span class="visible-mobile">上一篇</span>
                      </a>
                    
                  </article>
                  <article class="post-next col-6">
                    
                    
                      <a href="/2023/03/24/Hadoop/" title="Hadoop部署">
                        <span class="hidden-mobile">Hadoop部署</span>
                        <span class="visible-mobile">下一篇</span>
                        <i class="iconfont icon-arrowright"></i>
                      </a>
                    
                  </article>
                </div>
              
            </div>

            
  
  
    <article id="comments" lazyload>
      
  <div id="valine"></div>
  <script type="text/javascript">
    Fluid.utils.loadComments('#valine', function() {
      Fluid.utils.createScript('https://lib.baomitu.com/valine/1.5.1/Valine.min.js', function() {
        var options = Object.assign(
          {"appId":"geJAvpyCyYwmp1wI8u2CCkV5-gzGzoHsz","appKey":"WnNukDH4RUTtMsUwJvNG4vyR","path":"window.location.pathname","placeholder":null,"avatar":"retro","meta":["nick","mail","link"],"requiredFields":[],"pageSize":10,"lang":"zh-CN","highlight":false,"recordIP":false,"serverURLs":"","emojiCDN":null,"emojiMaps":null,"enableQQ":true},
          {
            el: "#valine",
            path: window.location.pathname
          }
        )
        new Valine(options);
        Fluid.utils.waitElementVisible('#valine .vcontent', () => {
          var imgSelector = '#valine .vcontent img:not(.vemoji)';
          Fluid.plugins.imageCaption(imgSelector);
          Fluid.plugins.fancyBox(imgSelector);
        })
      });
    });
  </script>
  <noscript>Please enable JavaScript to view the comments</noscript>


    </article>
  


          </article>
        </div>
      </div>
    </div>

    <div class="side-col d-none d-lg-block col-lg-2">
      
  <aside class="sidebar" style="margin-left: -1rem">
    <div id="toc">
  <p class="toc-header">
    <i class="iconfont icon-list"></i>
    <span>目录</span>
  </p>
  <div class="toc-body" id="toc-body"></div>
</div>



  </aside>


    </div>
  </div>
</div>





  



  



  



  



  







    

    
      <a id="scroll-top-button" aria-label="TOP" href="#" role="button">
        <i class="iconfont icon-arrowup" aria-hidden="true"></i>
      </a>
    

    
      <div class="modal fade" id="modalSearch" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
     aria-hidden="true">
  <div class="modal-dialog modal-dialog-scrollable modal-lg" role="document">
    <div class="modal-content">
      <div class="modal-header text-center">
        <h4 class="modal-title w-100 font-weight-bold">搜索</h4>
        <button type="button" id="local-search-close" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body mx-3">
        <div class="md-form mb-5">
          <input type="text" id="local-search-input" class="form-control validate">
          <label data-error="x" data-success="v" for="local-search-input">关键词</label>
        </div>
        <div class="list-group" id="local-search-result"></div>
      </div>
    </div>
  </div>
</div>

    

    
  </main>

  <footer>
    <div class="footer-inner">
  
    <div class="footer-content">
       <div class="zsqk"> <p>(￣▽￣)" 赞赏！</p> <div class="zstb"> <a  class="qr-trigger" target="_self"> <i class="iconfont icon-wechat-fill" aria-hidden="true"></i> <img class="qr-img animate__animated animate__bounc animate__fadeInDown" src="https://blog.qianyios.top/img/zansang/wxzf.png" srcset="/img/loading.gif" lazyload alt="qrcode" /> </a> <a  class="qr-trigger" target="_self"> <i class="iconfont icon-alipay-fill" aria-hidden="true"></i> <img class="qr-img animate__animated animate__bounc animate__fadeInDown" src="https://blog.qianyios.top/img/zansang/zfb.png" srcset="/img/loading.gif" lazyload alt="qrcode" /> </a>
</div>
<p class="zsyy animate__animated animate__bounce animate__flash animate__infinite	infinite animate__slow">如果对你有帮助，就请我喝一杯吧！！</p> </div> <br /> <a href="https://hexo.io" target="_blank" rel="nofollow noopener"><span>Hexo</span></a> <i class="iconfont icon-love"></i> <a href="https://github.com/fluid-dev/hexo-theme-fluid" target="_blank" rel="nofollow noopener"><span>Fluid</span></a> 
    </div>
  
  
    <div class="statistics">
  
  

  
    
      <span id="busuanzi_container_site_pv" style="display: none">
        总访问量 
        <span id="busuanzi_value_site_pv"></span>
         次
      </span>
    
    
      <span id="busuanzi_container_site_uv" style="display: none">
        总访客数 
        <span id="busuanzi_value_site_uv"></span>
         人
      </span>
    
    
  
</div>

  
  
  
</div>

  </footer>

  <!-- Scripts -->
  
  <script  src="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.js" ></script>
  <link  rel="stylesheet" href="https://lib.baomitu.com/nprogress/0.2.0/nprogress.min.css" />

  <script>
    NProgress.configure({"showSpinner":false,"trickleSpeed":100})
    NProgress.start()
    window.addEventListener('load', function() {
      NProgress.done();
    })
  </script>


<script  src="https://lib.baomitu.com/jquery/3.6.0/jquery.min.js" ></script>
<script  src="https://lib.baomitu.com/twitter-bootstrap/4.6.1/js/bootstrap.min.js" ></script>
<script  src="/js/events.js" ></script>
<script  src="/js/plugins.js" ></script>


  <script  src="https://lib.baomitu.com/typed.js/2.0.12/typed.min.js" ></script>
  <script>
    (function (window, document) {
      var typing = Fluid.plugins.typing;
      var subtitle = document.getElementById('subtitle');
      if (!subtitle || !typing) {
        return;
      }
      var text = subtitle.getAttribute('data-typed-text');
      
        typing(text);
      
    })(window, document);
  </script>




  
    <script  src="/js/img-lazyload.js" ></script>
  




  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/tocbot/4.18.2/tocbot.min.js', function() {
    var toc = jQuery('#toc');
    if (toc.length === 0 || !window.tocbot) { return; }
    var boardCtn = jQuery('#board-ctn');
    var boardTop = boardCtn.offset().top;

    window.tocbot.init(Object.assign({
      tocSelector     : '#toc-body',
      contentSelector : '.markdown-body',
      linkClass       : 'tocbot-link',
      activeLinkClass : 'tocbot-active-link',
      listClass       : 'tocbot-list',
      isCollapsedClass: 'tocbot-is-collapsed',
      collapsibleClass: 'tocbot-is-collapsible',
      scrollSmooth    : true,
      includeTitleTags: true,
      headingsOffset  : -boardTop,
    }, CONFIG.toc));
    if (toc.find('.toc-list-item').length > 0) {
      toc.css('visibility', 'visible');
    }

    Fluid.events.registerRefreshCallback(function() {
      if ('tocbot' in window) {
        tocbot.refresh();
        var toc = jQuery('#toc');
        if (toc.length === 0 || !tocbot) {
          return;
        }
        if (toc.find('.toc-list-item').length > 0) {
          toc.css('visibility', 'visible');
        }
      }
    });
  });
</script>


  <script src=https://lib.baomitu.com/clipboard.js/2.0.11/clipboard.min.js></script>

  <script>Fluid.plugins.codeWidget();</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/anchor-js/4.3.1/anchor.min.js', function() {
    window.anchors.options = {
      placement: CONFIG.anchorjs.placement,
      visible  : CONFIG.anchorjs.visible
    };
    if (CONFIG.anchorjs.icon) {
      window.anchors.options.icon = CONFIG.anchorjs.icon;
    }
    var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
    var res = [];
    for (var item of el) {
      res.push('.markdown-body > ' + item.trim());
    }
    if (CONFIG.anchorjs.placement === 'left') {
      window.anchors.options.class = 'anchorjs-link-left';
    }
    window.anchors.add(res.join(', '));

    Fluid.events.registerRefreshCallback(function() {
      if ('anchors' in window) {
        anchors.removeAll();
        var el = (CONFIG.anchorjs.element || 'h1,h2,h3,h4,h5,h6').split(',');
        var res = [];
        for (var item of el) {
          res.push('.markdown-body > ' + item.trim());
        }
        if (CONFIG.anchorjs.placement === 'left') {
          anchors.options.class = 'anchorjs-link-left';
        }
        anchors.add(res.join(', '));
      }
    });
  });
</script>


  
<script>
  Fluid.utils.createScript('https://lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js', function() {
    Fluid.plugins.fancyBox();
  });
</script>


  <script>Fluid.plugins.imageCaption();</script>

  <script  src="/js/local-search.js" ></script>

  <script defer src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" ></script>





<!-- 主题的启动项，将它保持在最底部 -->
<!-- the boot of the theme, keep it at the bottom -->
<script  src="/js/boot.js" ></script>


  

  <noscript>
    <div class="noscript-warning">博客在允许 JavaScript 运行的环境下浏览效果更佳</div>
  </noscript>
</body>
</html>
